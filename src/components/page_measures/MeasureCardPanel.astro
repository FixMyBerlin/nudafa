---
import { Image } from 'astro:assets'
import ProseMarkdown from '../ProseMarkdown.astro'
import { getGeometryByNudafaId } from 'src/utils/getGeometryByNudafaId'
import { MeasureMap } from './MeasureMap'

type Props = {
  measure: any
}

const { measure } = Astro.props

const feature = measure.data.id ? getGeometryByNudafaId(measure.data.id) : undefined

const { Content } = await measure.render()
---

<div class="flex flex-col gap-4 md:flex-row">
  <div>
    {
      measure.data.image && (
        <Image
          src={measure.data.image}
          alt=""
          class="aspect-[3/2] w-full shrink-0 object-cover md:h-[200px] md:w-auto md:pt-2 lg:h-[250px]"
        />
      )
    }
    {
      measure.data.imageCopyright && (
        <figcaption class="mt-2 text-left text-xs text-gray-400 md:text-sm">
          Â© {measure.data.imageCopyright}
        </figcaption>
      )
    }

    {
      feature && (
        <div class="h-[600px] w-[800px]">
          <MeasureMap client:load geometry={feature} />
        </div>
      )
    }
    <ProseMarkdown>
      <Content />
    </ProseMarkdown>
  </div>
</div>
